<dom-module id="marias-element">
  <template>
    <style>
      #number_display {
        height: 80px;
        width: 80px;
        border-radius: 60px;
        background-color: #FDC22E;
        color: #FFE907;
      }
      #number_display p {
          color: white;
      }

    </style>

    <div>
      <paper-input id="number_input" label="Enter a number" prevent-invalid-input allowed-pattern="[0-99]" type="number" char-counter value="{{inputNumber}}"></paper-input>
      <br>

      <!-- Los nombres de ids o clases, mejor con _, xq polymer busca los guiones medios para buscar componentes y se hace líos achuff
      Le he puesto un nombre al valor del input que he definido en el objeto de properties y le he añadido un observer. -->
      <paper-button id="number_display"><p>{{inputNumber}}</p></paper-button>
    </div>
  </template>
</dom-module>

<script>
  (function (){
    /*Si quieres jugar con el componente desde la consola:
      var mar = document.querySelector('marias-element');
      console.log(mar.name);
      mar.name = 'Maria'; =>> al poner el . verás todas las propiedades que tiene. Las que añades en properties se añades a las que vienen por defecto por ser un webComponent y por ser creado con Polymer().*/

    Polymer({
      is: "marias-element",

      properties: {
        name: {
          type: String,
          value: 'Maria´s name',
          observer: 'mariaChanged',
        },
        inputNumber: {
          type: Number,
          observer: 'inputNumberChanged'
        }
      },

      //Añado un listener de tap para el paper button (id.evento). Si no especificara el id del elemento, se escucharía a todos los eventos tap sobre el componente.

      //Se que hay un evento tap porque en paper-button.html veo que tiene el behaviour Polymer.PaperButtonBehavior(lin 144). En paper-button-behavior.html no veo tampoco ningún listener, pero sí que hereda de Polymer.IronButtonState. En iron-button-state.html (en iron-behaviors) veo el listener :))
      listeners: {
        'number_display.tap': '_tapHandler'
      },

      //element’s basic lifecycle

      created: function(){
        //registers the element with the browser and returns a constructor
        console.log('Maria´s element its been created!!');
      },

      ready: function(){
        //element’s local DOM is ready = properties are set to its values(default, attributes , binding..)
        console.log('Maria´s element its ready!!');
      },

      attached: function(){
        //elements is attached to document DOM
        console.log('Maria´s element its been attached!!');
      },

      mariaChanged: function(newValue, oldValue){
        console.log('Maria was ' + oldValue);
        console.log('and now is ' + newValue);
       // component.$.number_display.click();
      },

      inputNumberChanged: function(newValue){
        //Antes de nada guardo el componente, referido con this, para que no haya problemas de scope (sobretodo con callbacks donde this puede cambiar de referencia);
        var component = this;
        console.log('new number ' + newValue);
        //Polymer cachea todos los elementos a los que hayas asignado un id en un array para no tener que recorrer el DOM con querySelector y ser más eficiente
        if(newValue>80){
          alert("not valid!" + newValue);
        };
        console.log(component.$);
        component.$.number_display.click();

        var boton = this.querySelector("#number_display");
        var newMeasure = 80 + (2*newValue);
        console.log(newMeasure);
        boton.style.height = newMeasure + "px";
        boton.style.width = newMeasure + "px";
      },

      _tapHandler: function(event){
        console.log('Button clicked!');
        console.log(event);
        console.log(event.type);
      }

   /*   validate: function(value){
        console.log(value);
        var valueNum = parseInt(value, 10);
        console.log(valueNum);
        if(valueNum<100){return true}
        else {return false} 
      }*/
    });
  })();
</script>