<dom-module id="interactive-graph">
  <style type="text/css">
    #graphCanvas {
      background-color: #FFFDDC;
    }
    #slidersContainer {
      margin-top: 25px; 
      display: flex;
      flex-direction: column;
    }

    paper-slider.blue {
      --paper-slider-knob-color: var(--paper-light-blue-500);
      --paper-slider-active-color: var(--paper-light-blue-500);
    }

    paper-slider.red {
      --paper-slider-knob-color: var(--paper-red-500);
      --paper-slider-active-color: var(--paper-red-500);
    }

    paper-slider.green {
      --paper-slider-knob-color: var(--paper-green-500);
      --paper-slider-active-color: var(--paper-green-500);
    }


  </style>
  <template>
    <canvas id="graphCanvas" height="200px" width="300px">
      <p>{{sliderOneValue}}</p>
      <p></p>
      <p></p>
    </canvas>
    <p>{{sliderThreeValue}}</p>
    <div id="slidersContainer">
      <paper-slider value="{{sliderOneValue}}" id="slider1" class="blue"></paper-slider>
      <paper-slider value="{{sliderTwoValue}}" id="slider2" class="red"></paper-slider>
      <paper-slider value="{{sliderThreeValue}}" id="slider3" class="green"></paper-slider>
    </div>
  </template> 
  <script type="text/javascript">
    (function(){
      Polymer ({
        is: "interactive-graph",
        properties: {
          graph: {
            type: String
          },

          sliderOneValue: {
          type: Number,
          observer: "sliderOneValueChanged"
         },
         sliderTwoValue: {
          type: Number,
          observer: "sliderTwoValueChanged"
         }, 
         sliderThreeValue: {
          type: Number,
          observer: "sliderThreeValueChanged"
         }
        },
        sliderOneValueChanged: function (newValue, oldValue){

          var canvas = this.querySelector("#graphCanvas");
          var ctx = canvas.getContext('2d');
          ctx.fillStyle = "#03A9F4";
          if(newValue<oldValue){
            ctx.clearRect (7, 10, oldValue*3, 2);
          }
          ctx.fillRect (7, 10, newValue*3, 2); 
        },

        sliderTwoValueChanged: function (newValue, oldValue){

          var canvas = this.querySelector("#graphCanvas");
          var ctx = canvas.getContext('2d');
          ctx.fillStyle = "red";
          if(newValue<oldValue){
            ctx.clearRect (7, 30, oldValue*3, 50);
          }
          ctx.fillRect (7, 30, newValue*3, 50); 
        },

        sliderThreeValueChanged: function (newValue, oldValue){
          var canvas = this.querySelector("#graphCanvas");
          var ctx = canvas.getContext("2d");
          // LOOK WHAT YOUVE DONEEEE YOUVE BROKE MEEEEE :(
          // Antes de empezar pone toda la fila en blanco
          ctx.fillStyle = "#FFFDDC";
          var expon = new Path2D();
          expon.moveTo(45, 145);
          expon.arc(45, 145, 37, 0, 360, false);
          expon.moveTo(125, 145)
          expon.arc(125, 145, 37, 0, 360, false);
          expon.moveTo(210, 145);
          expon.arc(210, 145,37, 0, 360, false);
          ctx.fill(expon);
          // pone el fillStyle en verde y colorea con el nuevo valor
          ctx.fillStyle = "green";
          var expon = new Path2D();
          switch(newValue){
            case (newValue < 33):
              alert("HEY");
              expon.moveTo(45, 145);
              expon.arc(45, 145, 35, 0, newValue/6, false);
            break;
            case (newValue > 34 && newValue < 67):
              alert("HO");
              expon.moveTo(45, 145);
              expon.arc(45, 145, 35, 0, 360, false);
              expon.moveTo(125, 145)
              expon.arc(125, 145, 35, newValue/6, oldValue/6, false);
            break;
            case (newValue > 68 && newValue < 100):
              alert("wut?");
              expon.moveTo(45, 145);
              expon.arc(45, 145, 35, 0, 360, false);
              expon.moveTo(125, 145)
              expon.arc(125, 145, 35, 0, 360, false);
              expon.moveTo(210, 145);
              expon.arc(210, 145, 35, newValue/6, oldValue/6, false);
            break;
          }
          ctx.fill(expon);

          /* chapuza a cambiar 
          if(oldValue>newValue){
            ctx.fillStyle = "#FFFDDC";
            var expon = new Path2D();
            expon.moveTo(45, 145);
            expon.arc(45, 145, 37, 0, 360, false);
            expon.moveTo(125, 145)
            expon.arc(125, 145, 37, 0, 360, false);
            expon.moveTo(210, 145);
            expon.arc(210, 145,37, 0, 360, false);
            ctx.fill(expon);
            ctx.fillStyle = "green";
            var expon = new Path2D();
            if(newValue>0 && newValue<33) {
              expon.moveTo(45, 145);
              expon.arc(45, 145, 35, 0, newValue/6, false);
            }
            if(newValue>34){
              expon.moveTo(125, 145)
              expon.arc(125, 145, 35, newValue/6, oldValue/6, false);
            }
            if(newValue>67){
                expon.moveTo(210, 145);
                //expon.arc(210, 145, 35, 0, 360, false);
                expon.arc(210, 145, 35, newValue/6, oldValue/6, false);
            }
            ctx.fill(expon);
          }
          else {
            ctx.fillStyle = "green";
            var expon = new Path2D();
            if(newValue>0 && newValue<33) {
              expon.moveTo(45, 145);
              expon.arc(45, 145, 35, 0, newValue/6, false);
            }
            if(newValue>34){
              expon.moveTo(125, 145)
              expon.arc(125, 145, 35, oldValue/6, newValue/6, false);
            }
            if(newValue>67){
                expon.moveTo(210, 145);
                //expon.arc(210, 145, 35, 0, 360, false);
                expon.arc(210, 145, 35, oldValue/6, newValue/6, false);
            }
            ctx.fill(expon);*/
          
        }
      });
    })();
    /*var canvas = document.getElementById('graphCanvas');
    if(canvas.getContext){
     var ctx = canvas.getContext('2d');
    }
    else {
      alert("Your browser does not support this :_(");
    }*/
  </script>
</dom-module>